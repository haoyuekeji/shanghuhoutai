/*By 任龙飞—renlongfei*/
function addhtml(){$(".all").html(""),$(".all").append('<div class="cjnums"><span>抽奖数量</span><input class="cjnums-con" placeholder="抽奖数量" /></div><div class="cjnumber"><span>抽奖号码</span><div class="input"><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /></div></div><div class="add"><img src="images/add.png" alt="" width="100%"></div><div class="sure">确定</div>')}function addhtml1(s){if($(".all").html(""),0===s.length)return $(".all").html("您没有抽奖订单！"),!1;for(var e=0;e<s.length;e++){var i=s[e].products[0].indexImages.split(",")[0];$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+i+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s[e].orderCode+"</div>\n"+s[e].products[0].pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s[e].produtsTypes[0].color+'</span>\n<span class="chima">尺码：'+s[e].produtsTypes[0].size+'</span>\n</div>\n<div class="price price-charge">\n售价：￥'+s[e].totalPrice+'    </div>\n    <span class="nums num">\n</span>\n</div>\n<div class="details-right-charge">\n    <div class="address">\n'+s[e].address.receiver+s[e].address.phone+"<br>\n"+s[e].address.address+'</div>\n<div class="status">\n抽奖码 '+s[e].luckcode+'</div>\n<div class="data">\n'+s[e].createDate+'</div>\n<div class="fahuo wuliu-details" title="">\n未中奖\n</div>\n</div>\n<div class="details-details-cons"><div class="details-details-con"><div class="details-ul"><ul><li>无</li><li>无</li></ul></div></div></div>\n    </div>')}}function addhtml2(s){if($(".all").html(""),0===s.length)return $(".all").html("您没有已中奖订单！"),!1;for(var e=0;e<s.length;e++){var i=s[e].products[0].indexImages.split(",")[0];$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+i+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s[e].orderCode+"</div>\n"+s[e].products[0].pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s[e].produtsTypes[0].color+'</span>\n<span class="chima">尺码：'+s[e].produtsTypes[0].size+'</span>\n</div>\n<div class="price price-charge">\n<div class="status">\n总价：'+s[e].totalPrice+'</div>\n    </div>\n</div>\n<div class="details-right-charge">\n    <div class="address">\n'+s[e].address.receiver+s[e].address.phone+"<br>\n"+s[e].address.address+'</div>\n<div class="status">\n抽奖码 '+s[e].luckcode+'</div>\n<div class="data">\n'+s[e].createDate+'</div>\n<div class="fahuo" title="">\n发货\n</div>\n</div>\n<div class="details-details-cons"><div class="details-details-con"><div class="details-ul"><div><input type="text" class="details-ul-input" placeholder="物流公司"></div><ul></ul></div><span class="oid" style="display: none">'+s[e].id+'</span><div class="express"><input type="text" placeholder="物流订单号"></div><div class="express-sure">确定发货</div></div></div>\n</div>')}}addhtml(),$(".add").click(function(){$(".cjnumber").append('<div class="input"><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /><input class="cjnumber-con" placeholder="抽奖号码" /></div>')}),$(".body-top li").click(function(){var s=$(this).index();switch(console.log(s),s){case 0:addhtml();break;case 1:$.post(localhost+"/order/list",{sellerId:token,luckdraw:!0,online_code:onlinecode},function(s){outline(s);addhtml1(s.data.content)});break;case 2:$.post(localhost+"/order/list",{sellerId:token,luck:!0,online_code:onlinecode},function(s){outline(s);addhtml2(s.data.content)})}}),$(".all").on("click",".sure",function(){for(var s=[],e=$(".cjnumber").find("input").length,i=$(".cjnums").find("input").val(),l=0;l<e;l++)s.push($(".cjnumber").find("input").eq(l).val());$.post(localhost+"/luckdraw/save",{sellerId:token,allNumber:i,lackNumber:s.join("="),online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&alert(s.message)})});function findlist(s,e,i){for(var l=[],n=0;n<s.length;n++)l.push(s[n].indexOf(i));for(var d=0;d<l.length;d++)l[d]>=0&&(showlist.push(s[d]),enlist.push(e[d]))}$("body").on("click",".fahuo",function(){""===$(this).attr("title")?($(this).parents(".details-right-charge").siblings(".details-details-cons").stop(!0).slideDown(),$(this).prop("title","发货")):($(this).parents(".details-right-charge").siblings(".details-details-cons").stop(!0).slideUp(),$(this).prop("title",""))}),$("body").on("input",".details-ul-input",function(){showlist=[],enlist=[];var s=$(this).val();$(this).parents().siblings(".details-ul ul").html("");/^[\u4E00-\u9FA5]+$/.test(s)&&findlist(list_zh,list_en,s);for(var e=0;e<showlist.length;e++)$(this).parents().siblings(".details-ul ul").append("<li>"+showlist[e]+"</li>");""===s&&$(this).parents().siblings(".details-ul ul").html("")}),$("body").on("click",".details-ul li",function(){dename=[],dename.push(enlist[$(this).index()]),$(this).parents(".details-ul ul").siblings("div").find(".details-ul-input").val($(this).text()),$(this).parents(".details-ul ul").html("")}),$("body").on("click",".express-sure",function(){var s=[],e=$(this).parents(".details").index(),i=$(this).siblings(".oid").text(),l=($(this).siblings(".deliverPrice").text(),$(this).siblings(".express").find("input").val()),n=$(this).siblings(".details-ul").find("input").val();s.push(dename[0]),$.post(localhost+"/deliver/save",{oid:i,token:token,dcode:l,dname:n,price:0,dename:s[0],online_code:onlinecode},function(d){outline(d),"操作成功"===d.message?(alert(d.message),$.post(localhost+"/order/changeState",{oid:i,state:"待收货订单",sellerId:token,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$(".all").find(".details").eq(e).remove()})):"信息已存在"===d.message&&confirm("快递"+d.message+"!，确认继续吗？")&&$.post(localhost+"/deliver/save",{oid:i,token:token,dcode:l,dname:n,price:0,dename:s[0],iscontinue:"yes",online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$.post(localhost+"/order/changeState",{oid:i,state:"待收货订单",sellerId:token,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$(".all").find(".details").eq(e).remove()})})})});
/*2018-01-04*/