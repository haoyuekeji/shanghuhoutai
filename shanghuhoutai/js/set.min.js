/*By 任龙飞—renlongfei*/
var PhoneCode,you_=/^[A-Za-z0-9._%-]+@([A-Za-z0-9-]+\.)+[A-Za-z]{2,4}$/,mm=/^(?![^a-zA-Z]+$)(?!\D+$)/,mima_=!1,mima1_=!1,mima2_=!1,yanzheng_mima="0",sta=0,time=60,Phone=!1,edit_number=0,moudle_number=0,express=0,express_all=[],index_span=0,express_index=0,banner_content=[];function sort_img(e,n){$(n).html(""),e.forEach(function(e,i){$(n).append('<div class="show-img-con"><div class="last"><</div><img src="'+e+'" alt="" width=\'100%\'><div class="next">></div><div class="loading-show-img-del"><img src="images/del.png" alt="" width=\'100%\'></div></div>')})}function arrow_show(e,n,i){switch(n){case"mouseover":var t=0;break;case"mouseleave":t="-20px"}$(e).on(n,i,function(){$(this).find(".last").stop(!0).animate({left:t},300),$(this).find(".next").stop(!0).animate({right:t},300)})}function ArrChange(e,n,i){switch(e){case 0:i>0&&(n.splice(i-1,0,n[i]),n.splice(i+1,1));break;case 1:i<n.length-1&&(n.splice(i+2,0,n[i]),n.splice(i,1))}}function del_img(e,n,i){i.splice(e,1),sort_img(i,n)}$.post(localhost+"/seller/index",{token:token,pageSize:20,active:!0,online_code:onlinecode},function(e){outline(e),sort_img(banner_content=e.data[0].split(","),".loading-show-img"),arrow_show(".loading-show-img","mouseover",".show-img-con"),arrow_show(".uploading-show-img","mouseover",".show-img-con"),arrow_show(".loading-show-img","mouseleave",".show-img-con"),arrow_show(".uploading-show-img","mouseleave",".show-img-con"),$(".loading-show-img").on("click",".last",function(){var e=$(this).parents(".show-img-con").index();ArrChange(0,banner_content,e),sort_img(banner_content,".loading-show-img")}),$(".loading-show-img").on("click",".next",function(){var e=$(this).parents(".show-img-con").index();ArrChange(1,banner_content,e),sort_img(banner_content,".loading-show-img")}),$("body").on("click",".loading-show-img-del",function(){var e=$(this).parents().parents()[0].className,n=$(this).parents().index();switch(e){case"loading-show-img":del_img(n,".loading-show-img",banner_content)}}),$(".loading-show-sure").click(function(){$.post(localhost+"/seller/update",{sellerId:token,online_code:onlinecode,banners:banner_content.join(","),token:token},function(e){"操作成功"===e.data&&(alert("更改成功！"),$.post(localhost+"/seller/index",{token:token,pageSize:20,active:!0,online_code:onlinecode},function(e){outline(e);sort_img(e.data[0].split(","),".loading-show-img")}))})})});function addhtml_(e,n){if($(".moudle-body").html(""),0===n.length)return $(".moudle-name").append("<div>暂无模板！</div>"),!1;$(".moudle-body").append('<div class="moudle"><div class="moudle-top"><div class="input"><span>快递名称：</span><input type="text" calss="dname"  value='+n[e][0].dname+'><ul></ul></div><div class="input"><span>发货地址：</span><textarea name="" id="" cols="30" rows="2">'+n[e][0].origin_address+'</textarea></div><div class="input"><span>计价方式：</span><input type="radio" name="express'+express+'">按件数<input type="radio" name="express'+express+'">按重量</div><div class="input">运送方式：快递</div><div class="sure" title="展开">隐藏</div></div><div class="freight"><span>默认运费</span><input type="text" value='+n[e][0].account+'><span class="jian">件</span><input type="text" value='+n[e][0].more_account+'><span>元，每增加</span><input type="text" value='+n[e][0].price+'><span class="jian">件</span><span>，运费增加</span><input type="text" value='+n[e][0].more_price+'><span>元</span><span class="moudle-up" title="展开"> <img src="images/arrow.png" alt="" width="100%"></span><span class="post_dname" style="display:none">'+n[e][0].dname+'</span> <span class="moudle-del">删除模板</span></div><div class="moudle-con"> <div class="moudle-con-top"> <div class="left"> <span>运送到</span> </div> <div class="con"> <a>首<span class="xjian">件数</span>  </a>  <a> 首费/元 </a>  <a>续<span class="jian">件</span>数 </a> <a>续费/元</a> </div> </div> </div><div class="add-moudle-details"> 点击！为指定地区城市设置邮费</div><div class="express-sure">确 定</div></div>');for(var i=1;i<n[e].length;i++)$(".moudle-con").append('<div class="moudle-con-body"><div class="id">'+n[e][i].id+'</div><div class="left"><span class="address">'+n[e][i].destination+'</span><span class="edit">编 辑</span></div><div class="con"><input type="text" value='+n[e][i].account+'><input type="text" value='+n[e][i].price+'><input type="text" value='+n[e][i].more_account+'><input type="text" value='+n[e][i].more_price+'> </div><div class="gengxin">更新</div><div class="moudle-details-del">  删 除</div></div>');"件数"===n[e][0].price_type?($(".moudle-top").eq(0).find("input[type=radio]").eq(0).prop("checked",!0),$(".moudle").eq(0).find(".jian").html("件"),$(".moudle").eq(0).find(".xjian").html("件")):($(".moudle-top").eq(0).find("input[type=radio]").eq(1).prop("checked",!0),$(".moudle").eq(0).find(".jian").html("/kg"),$(".moudle").eq(0).find(".xjian").html("重"))}$.post(localhost+"/seller/index",{token:token,pageSize:20,active:!0,online_code:onlinecode},function(e){if(outline(e),null!==e.data[3])for(var n=$(".banner-pic").find("input"),i=e.data[3].split(","),t=0;t<n.length;t++)n.eq(t).val(i[t])});function findlist(e,n,i){for(var t=[],o=0;o<e.length;o++)t.push(e[o].indexOf(i));for(var a=0;a<t.length;a++)t[a]>=0&&(showlist.push(e[a]),enlist.push(n[a]))}$.post(localhost+"/seller/findOne",{token:token,online_code:onlinecode},function(e){outline(e),null===e.data.sellerEmail?($(".email .hint").html("请先绑定邮箱！").fadeIn(),setTimeout(function(){$(".email .hint").fadeOut()},1200)):$(".email").find("input").val(e.data.sellerEmail)}),$.post(localhost+"/deliver/getTemplate",{sellerId:token,online_code:onlinecode},function(e){outline(e);for(var n=e.data,i=0;i<n.length;i++)$(".moudle-name").append("<span>"+n[i][0].dname+"</span>");addhtml_(index_span,n),$(".moudle-name span").eq(0).addClass("seclect").siblings(".moudle-name span").removeClass("seclect")}),$(".moudle-name").on("click","span",function(){index_span=$(this).index(),$(".moudle-name span").eq(index_span).addClass("seclect").siblings(".moudle-name span").removeClass("seclect"),$.post(localhost+"/deliver/getTemplate",{sellerId:token,online_code:onlinecode},function(e){outline(e),$(".moudle-name").html("");for(var n=e.data,i=0;i<n.length;i++)$(".moudle-name").append("<span>"+n[i][0].dname+"</span>");addhtml_(index_span,n),$(".moudle-name span").eq(index_span).addClass("seclect").siblings(".moudle-name span").removeClass("seclect")})});for(var i=0;i<province.length;i++){$(".cover").append('<div class="province"><div class="province-left"><input type="checkbox"><span>'+province[i][0]+'</span></div><div class="province-right"></div></div>');for(var k=1;k<province[i].length;k++)$(".province-right").eq(i).append(' <div class="city"><input type="checkbox"><span>'+province[i][k]+"</span></div>")}$(".bang").click(function(){var e=$(".email").find("input").val();""!==e&&you_.test(e)?($(".email-warn").eq(0).html(""),$.post(localhost+"/seller/update",{token:token,sellerEmail:e,online_code:onlinecode},function(e){outline(e),"操作成功"===e.data?($(".email .hint").html("绑定成功！").fadeIn(),setTimeout(function(){$(".email .hint").fadeOut()},1200)):($(".email .hint").html("绑定失败！").fadeIn(),setTimeout(function(){$(".email .hint").fadeOut()},1200))})):$(".email-warn").eq(0).html("格式不正确！")}),$(".mima").find("input").eq(0).blur(function(){var e=$(this).val();$.post(localhost+"/seller/checkPass",{token:token,oldPass:e,online_code:onlinecode},function(e){outline(e),"原密码不正确"===e.message?$(".email-warn").eq(1).html("原密码不正确！"):(mima_=!0,$(".email-warn").eq(1).html(""))})}),$(".mima").find("input").eq(1).blur(function(){var e=$(this).val();mm.test(e)?$(".email-warn").eq(2).html(""):$(".email-warn").eq(2).html("密码应为6—18位字母加数字！")}),$(".mima").find("input").eq(2).blur(function(){$(".mima").find("input").eq(1).val()===$(this).val()?($(".email-warn").eq(3).html(""),mima1_=!0):(mima1_=!1,$(".email-warn").eq(3).html("密码不一致！"))}),$(".yanzheng").click(function(){$.post(localhost+"/seller/getPhoneCode",{token:token},function(e){e.error?alert(e.message):"操作成功"===e.message&&(yanzheng_mima=e.data)})}),$(".mima").find("input").eq(3).blur(function(){$(this).val()===yanzheng_mima&&(mima2_=!0)}),$(".sure-mima").click(function(){var e=$(".mima").find("input").eq(1).val();!0===mima_&&!0===mima1_&&!0===mima2_?$.post(localhost+"/seller/update",{token:token,sellerPass:e,online_code:onlinecode},function(e){outline(e),"操作成功"===e.data?($(".mima .hint-sure").html("修改成功！").fadeIn(),setTimeout(function(){$(".mima .hint-sure").fadeOut()},1200)):($(".mima .hint-sure").html("修改失败！").fadeIn(),setTimeout(function(){$(".mima .hint-sure").fadeOut()},1200))}):($(".mima .hint-sure").html("操作有误！").fadeIn(),setTimeout(function(){$(".mima .hint-sure").fadeOut()},1200))}),$(".phone").find("input").eq(0).on("input",function(){var e=$(this).val();11===e.length&&$.post(localhost+"/seller/findOne ",{sellerPhone:e,online_code:onlinecode},function(e){outline(e),null===e.data?($(".phone .email-warn").html("账号已存在！"),Phone=!1):($(".phone .email-warn").html(""),Phone=!0)})}),$(".yanzhengma").click(function(){if(0===sta&&!0===Phone){sta=1,$(".yanzhengma").html(time+"s后重新获取").css({background:"#ccc",color:"#000"}),$.post(localhost+"/seller/getPhoneCode",{token:token,online_code:onlinecode},function(e){outline(e),PhoneCode=e.data});var e=setInterval(function(){0===--time?(time=60,$(".yanzhengma").html("点击获取验证码").css({background:"#00d6f8",color:"#000"}),sta=0,clearInterval(e)):$(".yanzhengma").html(time+"s后重新获取").css({background:"#ccc",color:"#000"})},1e3)}else $(".phone .hint-phone").html("账号已存在！").fadeIn(),setTimeout(function(){$(".phone .hint-phone").fadeOut()},1200)}),$(".sure-phone").click(function(){var e=$(".phone").find("input").eq(0).val(),n=$(".phone").find("input").eq(1).val();""!==n&&n===PhoneCode?$.post(localhost+"/seller/update",{token:token,sellerPhone:e,online_code:onlinecode},function(e){outline(e),"操作成功"===e.data?($(".phone .hint-phone").html("更换成功！").fadeIn(),setTimeout(function(){$(".phone .hint-phone").fadeOut()},1200)):($(".phone .hint-phone").html("更换失败！").fadeIn(),setTimeout(function(){$(".phone .hint-phone").fadeOut()},1200))}):($(".phone .hint-phone").html("验证码错误！").fadeIn(),setTimeout(function(){$(".phone .hint-phone").fadeOut()},1200))}),$("#uploading").fileinput({language:"zh",uploadUrl:localhost+"/seller/update",allowedFileExtensions:["jpg","png","gif"],maxFileCount:3,enctype:"multipart/form-data",showUpload:!0,showCaption:!1,uploadAsync:!1,browseClass:"btn btn-primary",previewFileIcon:"<i class='glyphicon glyphicon-king'></i>",uploadExtraData:function(e,n){var i={};return i.token=token,i.online_code=onlinecode,i}}).on("filebatchuploadsuccess",function(e,n){"操作成功"===n.response.data&&$.post(localhost+"/seller/index",{token:token,pageSize:20,active:!0,online_code:onlinecode},function(e){outline(e),sort_img(banner_content=e.data[0].split(","),".loading-show-img")})}).on("filebatchuploaderror",function(e,n){"文件过大"===n.response.error&&($(" .banner-hint").html(n.response.error+"！").fadeIn(),setTimeout(function(){$(".banner-hint").fadeOut()},1200))}),$("#uploading-video").fileinput({language:"zh",uploadUrl:localhost+"/seller/update",allowedFileExtensions:["mp4","avi","rmvb"],maxFileCount:1,enctype:"multipart/form-data",showUpload:!0,showCaption:!1,uploadAsync:!1,browseClass:"btn btn-primary",previewFileIcon:"<i class='glyphicon glyphicon-king'></i>",uploadExtraData:function(e,n){var i={};return i.token=token,i.online_code=onlinecode,i}}).on("filebatchuploadsuccess",function(e,n){}).on("filebatchuploaderror",function(e,n){"文件过大"===n.response.error&&($(" .banner-hint").html(n.response.error+"！").fadeIn(),setTimeout(function(){$(".banner-hint").fadeOut()},1200))}),$(".banner-pic-sure").click(function(){for(var e=$(this).siblings(".input").find("input"),n=[],i=0;i<e.length;i++)n.push(e.eq(i).val());$.post(localhost+"/seller/update",{token:token,lunbo:n.join(","),online_code:onlinecode},function(e){outline(e),"操作成功"===e.data&&alert(e.data+"!")})}),$("body").on("click",".add-moudle-details",function(){$(this).siblings(".moudle-con").append('<div class="moudle-con-body"><div class="left"><span class="address"></span><span class="edit">编 辑</span></div><div class="con"><input type="text"><input type="text"><input type="text"><input type="text"> </div><div class="moudle-details-del">  删 除</div></div>')}),$("body").on("click",".add-moudle",function(){$("body").find("input").removeAttr("disabled"),$(".moudle-name div").html(""),express++,$(this).siblings(".moudle-body").append('<div class="moudle"><div class="moudle-top"><div class="input"><span>快递名称：</span><input type="text" calss="dname"><ul></ul></div><div class="input"><span>发货地址：</span><textarea name="" id="" cols="30" rows="2"></textarea></div><div class="input"><span>计价方式：</span><input type="radio" name="express'+express+'" checked>按件数<input type="radio" name="express'+express+'">按重量</div><div class="input">运送方式：快递</div><div class="sure" title="展开">隐藏</div></div><div class="freight"><span>默认运费</span><input type="text"><span class="jian">件</span><input type="text"><span>元，每增加</span><input type="text"><span class="jian">件</span><span>，运费增加</span><input type="text"><span>元</span><span class="moudle-up" title="展开"> <img src="images/arrow.png" alt="" width="100%"></span> <span class="moudle-del">删除模板</span></div><div class="moudle-con"> <div class="moudle-con-top"> <div class="left"> <span>运送到</span> </div> <div class="con"> <a>首<span class="xjian">件数</span>  </a>  <a> 首费/元 </a>  <a>续<span class="jian">件</span>数 </a> <a>续费/元</a> </div> </div><div class="moudle-con-body"><div class="left"><span class="address"></span><span class="edit">编 辑</span></div> <div class="con"> <input type="text"> <input type="text"> <input type="text"> <input type="text"> </div> <div class="moudle-details-del">    删 除</div> </div></div><div class="add-moudle-details"> 点击！为指定地区城市设置邮费</div><div class="express-sure">确 定</div></div>')}),$(".moudle-body").on("input",".moudle-top input",function(){showlist=[],enlist=[];var e=$(this).val();$(this).siblings("ul").html("");/^[\u4E00-\u9FA5]+$/.test(e)&&findlist(list_zh,list_en,e);for(var n=0;n<showlist.length;n++)$(this).siblings("ul").append("<li>"+showlist[n]+"</li>");""===e&&$(this).siblings("ul").html("")}),$(".moudle-body").on("click",".moudle-top li",function(){$(this).parents("ul").siblings("input").val($(this).text()),$(this).parents("ul").html("")}),$(".moudle-body").on("blur",".moudle-top input",function(){$(this).val("")}),$(".moudle-body").on("click",function(){$(".moudle-top ul").html("")}),$("body").on("click",".moudle-up",function(){var e=$(this).parents().parents().index();$(".moudle-top").eq(e).find("input").val();"展开"!==$(this).attr("title")&&($(this).parents().siblings(".moudle-top").slideDown(),$(this).attr("title","展开"))}),$("body").on("click",".sure",function(){if(""===$(this).siblings(".input").find("input").val()||""===$(this).siblings(".input").find("textarea").val())return alert("此处信息不可为空！"),!1;$(this).parents(".moudle-top").slideUp(),$(this).parents(".moudle-top").siblings(".freight").children(".moudle-up").attr("title","关闭")}),$(".moudle-body").on("click",".moudle-details-del",function(){var e=$(this).siblings(".id").text(),n=$(this).parents().parents().parents().index();$(this);confirm("您确定要删除本条详情吗？")&&(""!==$(this).parents(".moudle-con").siblings(".moudle-top").find("input").val()&&""!==e?$(this).parents(".moudle-con").find(".id").length>1?$.post(localhost+"/deliver/del",{id:e,sellerId:token,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message&&$.post(localhost+"/deliver/getTemplate",{sellerId:token,online_code:onlinecode},function(e){outline(e);var n=e.data;$(".moudle-name").html("");for(var i=0;i<n.length;i++)$(".moudle-name").append("<span>"+n[i][0].dname+"</span>");addhtml_(index_span,n)})}):alert("请点击右上角删除整个模板！"):$(".moudle").eq(n).find(".moudle-con-body").length>1?$(this).parents(".moudle-con-body").remove():alert("请点击右上角删除整个模板！"))}),$(".moudle-body").on("click",".moudle-del",function(){var e=$(this).siblings(".post_dname").text(),n=$(this).parents(".moudle").index();$(this);confirm("您确定要删除模板吗？")&&(""!==$(this).parents(".freight").siblings(".moudle-top").find("input").val()&&0===n?$.post(localhost+"/deliver/del",{sellerId:token,dname:e,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message&&(index_span-- >0?index_span--:index_span=0,alert(e.message),$.post(localhost+"/deliver/getTemplate",{sellerId:token,online_code:onlinecode},function(e){outline(e);var n=e.data;$(".moudle-name").html("");for(var i=0;i<n.length;i++)$(".moudle-name").append("<span>"+n[i][0].dname+"</span>");addhtml_(index_span,n)}))}):$(this).parents(".moudle").remove())}),$(".cover").on("click",".province span",function(){"disabled"===$(this).siblings("input").attr("disabled")?$(this).siblings("input").attr({click:"null"}):$(this).siblings("input").prop("checked")?$(this).siblings("input").prop("checked",!1):$(this).siblings("input").prop("checked",!0)}),$(".cover").on("click",".province-right",function(){var e=$(this).find("input").length;$(this).find("input:checked").length===e?$(this).siblings().find("input").prop("checked",!0):$(this).siblings().find("input").prop("checked",!1)}),$(".cover").on("click",".province-left",function(){$(this).find("input").prop("checked")?$(this).siblings().find("input").prop("checked",!0):$(this).siblings().find("input").prop("checked",!1)}),$(".moudle-body").on("click",".edit",function(){express_index=$(this).parents(".moudle").index();var e=$(".moudle").eq(express_index).find(".address").length,n=[],i=[],t=0===$(this).siblings(".address").html().split("，").length?[]:$(this).siblings(".address").html().split("，");console.log($(this).siblings(".address").html().split("，"));var o=$(".city").find("span").length,a=$(".city").find("span");$(".moudle").eq(express_index).find("input").prop("checked",!1).removeAttr("disabled");for(var l=0;l<e;l++){var s=$(".moudle").eq(express_index).find(".address").eq(l).html().split("，");n.push.apply(n,s)}for(var d=n.concat([]),p=d.length-1;p>=0;p--)for(var c=0;c<t.length;c++)d[p]===t[c]&&d.splice(p,1);console.log(d);for(var r=0;r<d.length;r++)for(var u=0;u<o;u++)d[r]===a.eq(u).text()&&a.eq(u).siblings("input").prop("checked",!0).prop({disabled:"disabled"}),d[r]===a.eq(u).text()&&a.eq(u).siblings("input").prop("checked",!0)&&(i.push(d[r]),n.length=0);for(var m=0;m<$(".province-right").length;m++){$(".province-right").eq(m).find("input").length===$(".province-right").eq(m).find("input:checked").length&&$(".province-left").eq(m).find("input").prop("checked",!0).attr({disabled:"disabled"})}$(".cover").fadeIn(),moudle_number=$(this).parents().parents().parents(".moudle").index(),edit_number=$(this).parents(".left").parents().index()-1}),$(".guanbi").click(function(){$(".cover").fadeOut()}),$(".cover-sure").click(function(){for(var e=[],n=[],i=$(".moudle").eq(express_index).find(".address").length,t=0;t<i;t++){var o=$(".moudle").eq(express_index).find(".address").eq(t).html().split("，");n.push.apply(n,o)}for(var a=0;a<$(".province-right").find("input").length;a++)$(".province-right").find("input").eq(a).prop("checked")&&!$(".province-right").find("input").eq(a).prop("disabled")&&e.push($(".province-right").find("input").eq(a).siblings().text());0!==e.length&&($(".moudle").eq(moudle_number).find(".address").eq(edit_number).html(e.join("，")),$(".cover").fadeOut(),$(".cover").find("input").prop("checked",!1))}),$(".moudle-body").on("click",".moudle-top input[type=radio]",function(){var e=$(this).index()-1;switch(moudle_number=$(this).parents().parents().parents(".moudle").index(),e){case 0:$(".moudle").eq(moudle_number).find(".jian").html("件"),$(".moudle").eq(moudle_number).find(".xjian").html("件");break;case 1:$(".moudle").eq(moudle_number).find(".jian").html("/kg"),$(".moudle").eq(moudle_number).find(".xjian").html("重")}}),$(".moudle-body").on("click",".gengxin",function(){var e=$(this).siblings(".id").text(),n=$(this).parents(".moudle-con-body").find(".address").text(),i=$(this).parents(".moudle-con-body").find("input").eq(0).val(),t=$(this).parents(".moudle-con-body").find("input").eq(1).val(),o=$(this).parents(".moudle-con-body").find("input").eq(2).val(),a=$(this).parents(".moudle-con-body").find("input").eq(3).val();$.post(localhost+"/deliver/update",{sellerId:token,id:e,destination:n,account:i,price:t,more_account:o,more_price:a,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message&&(alert(e.message),$.post(localhost+"/tuan/tdelivertemplates/list",{sellerId:token,online_code:onlinecode},function(e){outline(e);var n=e.data;$(".moudle-name").html("");for(var i=0;i<n.length;i++)$(".moudle-name").append("<span>"+n[i][0].dname+"</span>");addhtml_(index_span,n)}))})}),$(".moudle-body").on("click",".express-sure",function(){var e=$(this).parents(".moudle"),n=e.find(".id").length,i=0,t=e.find(".address").length,o=e.find(".freight").find("input").length,a=[],l=[];express_all=[];for(var s="",d=0;d<o;d++)a.push(e.find(".freight").find("input").eq(d).val());if(""!==e.find("textarea").val())for(var p=0;p<e.find("input[type=text]").length;p++){if(i=p>=1?p-1:0,p>=t&&(i=t-1),""===e.find("input[type=text]").eq(p).val()||""==e.find(".address").eq(i).text())return alert("请完善信息！"),!1;s=e.find("input").eq(0).val();var c=e.find("textarea").val(),r="";r=1===e.find(".input").eq(2).find("input:checked").index()?"件数":"重量"}else alert("请填写发货地址！");if(0===n){for(var u=0;u<e.find(".moudle-con-body").length;u++){var m=e.find(".moudle-con-body").eq(u).find(".address").text();l=[];for(var h=0;h<4;h++)l.push(e.find(".moudle-con-body").find(".con").find("input").eq(h).val());express_all.push(m+"#"+l.join("#"))}$.post(localhost+"/deliver/save_template",{sellerId:token,dname:s,account:a[0],price:a[1],more_account:a[2],more_price:a[3],origin_address:c,price_type:r,delivers:express_all.join("-"),online_code:onlinecode},function(n){outline(n),"操作成功"===n.message?(alert("添加成功！"),$.post(localhost+"/deliver/getTemplate",{sellerId:token,online_code:onlinecode},function(n){outline(n),e.remove();var i=n.data;$(".moudle-name").html("");for(var t=0;t<i.length;t++)$(".moudle-name").append("<span>"+i[t][0].dname+"</span>");addhtml_(i.length-1,i)})):alert(n.message)})}else for(var f=0;f<e.find(".moudle-con-body").length;f++)if(""===e.find(".moudle-con-body").eq(f).find(".id").text()){var v=e.find(".moudle-con-body").eq(f).find(".address").text(),g=e.find(".moudle-con-body").eq(f).find("input").eq(0).val(),b=e.find(".moudle-con-body").eq(f).find("input").eq(1).val(),_=e.find(".moudle-con-body").eq(f).find("input").eq(2).val(),x=e.find(".moudle-con-body").eq(f).find("input").eq(3).val();$.post(localhost+"/deliver/update",{sellerId:token,destination:v,account:g,price:b,more_count:_,more_price:x,dname:s,price_type:r,online_code:onlinecode},function(n){outline(n),"操作成功"===n.message&&$.post(localhost+"/deliver/getTemplate",{sellerId:token,online_code:onlinecode},function(n){outline(n),e.remove();var i=n.data;$(".moudle-name").html("");for(var t=0;t<i.length;t++)$(".moudle-name").append("<span>"+i[t][0].dname+"</span>");addhtml_(index_span,i)})})}});
/*2018-01-05*/