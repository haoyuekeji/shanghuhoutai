/*By 任龙飞—renlongfei*/
var order_type="2",reg=/^[0-9]{4}-[0-1]?[0-9]{1}-[0-3]?[0-9]{1}$/,reg1=/^[0-9]{4}\/[0-1]?[0-9]{1}\/[0-3]?[0-9]{1}$/,reg2=/^[0-9]{4}\.[0-1]?[0-9]{1}\.[0-3]?[0-9]{1}$/,amount_=[],saleNumber_=[],content,pages=0,pagesindex=0,showlist=[],enlist=[],dename=[],style,details,html_,nums=0;"0"===authority&&($(".body-top ul li:gt(0)").css({display:"none"}),$(".body-top ul").css({background:"#18cffb"})),$("body").on("click",".edit",function(){""===$(this).attr("title")?($(this).siblings(".details-details").stop(!0).slideDown(),$(this).prop("title","编辑")):($(this).siblings(".details-details").stop(!0).slideUp(),$(this).prop("title",""))});function addhtml1_(s){var t=[],e=s.tProducts.indexPic.split(",")[0],i=0,a="";s.tProducts.productsTypes.forEach(function(s,t){i+=s.amount}),t.push(i);var n=s.endDate;n=(n=new Date(Date.parse(n.replace(/-/g,"/")))).getTime();var d="已过期订单"===(a=s.isover?"已过期订单":"正在拼团团购订单")?s.endDate:function(s){var t=s-Date.now(),e=Math.floor(t/36e5),i=t-3600*e*1e3,a=Math.floor(i/6e4),n=(i-60*a*1e3)/1e3;return e.toString()+": "+a.toString()+": "+n.toFixed(1)}(n),l="已过期订单"===a?"截止时间":"剩余时间";$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+e+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s.code+"</div>\n"+s.tProducts.pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s.tProducts.productsTypes[0].color+'</span>\n<span class="chima">尺码：'+s.tProducts.productsTypes[0].size+'</span>\n</div>\n<div class="price price-charge">\n标价：￥<span style="color:black;text-decoration: none">'+s.tProducts.productsTypes[0].tuanPrice+'</div>\n    <span class="nums num">\n剩余库存：'+t[0]+"    已卖出： "+s.tProducts.saleNum+'\n</span>\n</div>\n<div class="details-right-charge">\n<span style="font-size:20px;color:red">'+a+'</span><div class="fahuo revise-price" title="">\n更多\n</div>\n</div>\n<div class="details-details-cons"><div class="details-details-con"><div class="details-ul-wait-pin"><ul><li class="wait-pin"><div>本订单所有人：'+s.tDeliver.receiver+"    <br>微信昵称："+s.wxname+"</div><div>拼主：<span>"+s.owner+'</span></div><div>还差<span style="color:red">'+(s.startNum-s.joinNum)+"</span>人</div><div>"+l+'：<span style="color:red">'+d+"</span></div></li></ul></div></div></div>\n    </div>")}function addhtml2_(s){var t=s.tProducts.indexPic.split(",")[0],e=0;s.tProducts.productsTypes.forEach(function(s,t){e+=s.amount}),amount_.push(e),$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+t+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s.code+"</div>\n"+s.tProducts.pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s.tProductsTypes.color+'</span>\n<span class="chima">尺码：'+s.tProductsTypes.size+'</span>\n</div>\n<div class="price price-charge">\n售价：￥'+s.totalPrice+'    </div>\n    <span class="nums num">\n剩余库存：'+amount_[0]+"已卖出： "+s.tProducts.saleNum+'\n</span>\n</div>\n<div class="details-right-charge">\n    <div class="address">\n'+s.tDeliver.receiver+s.tDeliver.phone+"<br>\n"+s.tDeliver.address+'</div>\n<div class="status">\n待签收 '+s.amount+"件 总价："+s.totalPrice+'</div>\n<div class="data">\n'+s.createDate+'</div>\n<span style="font-size:20px;">已发货个人订单</span><div class="fahuo wuliu-details" title="">\n查看物流详情\n</div>\n</div>\n<div class="details-details-cons"><div class="details-details-con"><div class="details-ul"><ul><li>'+s.tDeliver.dname+"</li><li>"+s.tDeliver.dcode+"</li></ul></div></div></div>\n    </div>")}function addhtml3_(s){var t=[],e=s.tProducts.indexPic.split(",")[0],i=0;s.tProducts.productsTypes.forEach(function(s,t){i+=s.amount}),t.push(i),$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+e+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s.code+"</div>\n"+s.tProducts.pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s.tProductsTypes.color+'</span>\n<span class="chima">尺码：'+s.tProductsTypes.size+'</span>\n</div>\n<div class="price price-charge">\n<div class="status">\n总价：'+s.totalPrice+'</div>\n    </div>\n    <span class="nums num">\n剩余库存：'+t[0]+'<span style="margin-left: 30px">已卖出：'+s.tProducts.saleNum+'</span>\n</span>\n</div>\n<div class="details-right-charge">\n    <div class="address">\n<span class="deliverId" style="display:none">'+s.tDeliver.id+"</span>"+s.tDeliver.receiver+s.tDeliver.phone+"<br>\n"+s.tDeliver.address+'</div>\n<div class="data">\n'+s.createDate+"<br><span>待发货数量："+s.amount+'</span></div>\n<span style="font-size:20px;color:red">未发货个人订单</span><div class="fahuo" title="">\n发货\n</div>\n</div>\n<div class="details-details-cons"><div class="details-details-con"><div class="details-ul"><div><input type="text" class="details-ul-input" placeholder="物流公司"></div><ul></ul></div><span class="oid" style="display: none">'+s.id+'</span><div class="express"><input type="text" placeholder="物流订单号"></div><div class="express-sure">确定发货</div></div></div>\n</div>')}function addhtml5_(s){var t=s.tProducts.indexPic.split(",")[0],e=0;s.tProducts.productsTypes.forEach(function(s,t){e+=s.amount}),amount_.push(e),$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+t+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s.code+"</div>\n"+s.tProducts.pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s.tProductsTypes.color+'</span>\n<span class="chima">尺码：'+s.tProductsTypes.size+'</span>\n</div>\n<div class="price price-charge" style="color:red">\n售价：￥'+s.totalPrice+'  &nbsp&nbsp<span style="text-decoration: line-through;color:#999;">'+s.tProductsTypes.newPrice+'</span>    </div>\n    <span class="nums num">\n剩余库存：'+amount_[0]+"已卖出： "+s.tProducts.saleNum+'\n</span>\n</div>\n<div class="details-right-charge">\n    <div class="address">\n'+s.tDeliver.receiver+s.tDeliver.phone+"<br>\n"+s.tDeliver.address+'</div>\n<div class="data">\n'+s.createDate+'<div class="status">\n已完成 '+s.amount+"件 总价："+s.totalPrice+'<br><span style="font-size:20px;color:red">已完成个人订单</span></div>\n</div>\n</div>\n    </div>')}function addhtml6_(s){var t=0,e=[];s.tuanOrdersList;s.tProducts.productsTypes.forEach(function(s,e){t+=s.amount}),e.push(t);var i=s.tProducts.indexPic.split(",")[0];$(".all").append('<div class="details"><div class="details-left"><img src="'+i+'" alt=""> </div> <div class="details-con width"><div class="details-con-top">'+s.tProducts.pname+'</div><div class="price price-charge price-tuan"> ￥'+s.tProducts.productsTypes[0].tuanPrice+" <span>￥"+s.tProducts.productsTypes[0].newPrice+'</span></div><span class="nums num">剩余库存：'+e[0]+" 已卖出："+s.tProducts.saleNum+" </span>  <div>团购号："+s.groupCode+"</div>   <span>订单号："+s.code+'</span></div><span style="font-size:20px;color:red">未发货团购订单</span><div class="fahuo-tuan" title=""> <input type="button" value="填写物流单号" name="true"> </div><div class="details-details-cons-tuan"> <div class="ordernumber-tuan"><div class="order-img" title="true"> <img src="images/arrow-down.png" alt="" width="100%"></div></div><div class="details-details-cons-tuan-cons">  <div class="details-details-cons-tuan-con"><div class="order-datails"> <div class="order-details-con"><span>'+s.tDeliver.receiver+s.tDeliver.phone+"</span> <span>"+s.tDeliver.address+'</span><span class="dliverid" style="display:none">'+s.tDeliver.id+'</span><span class="tuanid" style="display:none">'+s.id+'</span> </div><div class="order-details-con"> <span>颜色：'+s.tProducts.tProductsTypes.color+" 尺码："+s.tProducts.tProductsTypes.size+"</span> <span>待发货 "+s.amount+"件 总价"+s.totalPrice+'</span> </div> </div> <span class="order-creattime">'+s.tDeliver.createDate+'</span> <div class="express-tuan"> <div class="express-tuan-con">  <span>联系物流</span>   <input type="text" placeholder="运单号">  <input type="text" placeholder="物流公司"> <div class="fahuo-geren">    发货 </div> </div> </div> </div></div> </div></div>')}function addhtml7_(s){var t=0,e=[];s.tuanOrdersList;s.tProducts.productsTypes.forEach(function(s,e){t+=s.amount}),e.push(t);var i=s.tProducts.indexPic.split(",")[0];$(".all").append('<div class="details"><div class="details-left"> <img src="'+i+'" alt=""></div><div class="details-con width"> <div class="details-con-top">'+s.tProducts.pname+' </div> <div class="price price-charge price-tuan">'+s.tProducts.productsTypes[0].tuanPrice+"<span>￥"+s.tProducts.productsTypes[0].newPrice+"</span></div>   <span>待收货 "+s.amount+"件 总价"+s.totalPrice+'</span><br><span class="nums num">  剩余库存：'+e[0]+" 已卖出："+s.tProducts.saleNum+" </span>  <div>团购号："+s.groupCode+"</div>   <span>订单号："+s.code+'</span> </div><span style="font-size:20px;color:red">已发货团购订单</span> <div class="fahuo-tuan-ready" title="true">   <input type="button" value="查看详情" name="true"> </div> <div class="details-details-cons-tuan-ready"><div class="details-details-cons-tuan-con">   <div class="order-datails">  <div class="order-details-con">  <span>'+s.tDeliver.receiver+"   "+s.tDeliver.phone+"</span>    <span>"+s.tDeliver.address+'</span> </div> <div class="order-details-con"> <span>颜色：'+s.tProductsTypes.color+" 尺码："+s.tProductsTypes.size+"</span><br>   <span>待收货 "+s.amount+"件 总价"+s.totalPrice+'</span> </div> </div> <span class="order-creattime">下单时间：'+s.tDeliver.createDate+'</span> </div> <div class="order-number-ready">   运单号：<span class="dcode">'+s.tDeliver.dcode+'</span> </div> <div class="order-number-ready">   快递公司：<span class="dcode">'+s.tDeliver.dname+"</span> </div> </div> </div></div>")}function addhtml8_(s){var t=0,e=[];s.tuanOrdersList;s.tProducts.productsTypes.forEach(function(s,e){t+=s.amount}),e.push(t);var i=s.tProducts.indexPic.split(",")[0];$(".all").append('<div class="details"><div class="details-left"> <img src="'+i+'" alt=""></div><div class="details-con width"> <div class="details-con-top">'+s.tProducts.pname+' </div> <div class="price price-charge price-tuan">'+s.tProducts.productsTypes[0].tuanPrice+"<span>￥"+s.tProducts.productsTypes[0].newPrice+"</span></div><span>已完成 "+s.amount+"件 总价"+s.totalPrice+'</span><br><span class="nums num">  剩余库存：'+e[0]+" 已卖出："+s.tProducts.saleNum+" </span>  <div>团购号："+s.groupCode+"</div>   <span>订单号："+s.code+'</span> </div><span style="font-size:20px;color:red">已完成团购订单</span> <div class="fahuo-tuan-ready" title="true">   <input type="button" value="查看详情" name="true"> </div> <div class="details-details-cons-tuan-ready"><div class="details-details-cons-tuan-con">   <div class="order-datails">  <div class="order-details-con">  <span>'+s.tDeliver.receiver+"   "+s.tDeliver.phone+"</span>    <span>"+s.tDeliver.address+'</span> </div> <div class="order-details-con"> <span>颜色：'+s.tProductsTypes.color+" 尺码："+s.tProductsTypes.size+"</span><br>   <span>已完成 "+s.amount+"件 总价"+s.totalPrice+'</span> </div> </div> <span class="order-creattime">下单时间：'+s.tDeliver.createDate+'</span> </div> <div class="order-number-ready">   运单号：'+s.tDeliver.dcode+' </div> <div class="order-number-ready">   快递公司：'+s.tDeliver.dname+" </div> </div> </div></div>")}function addhtml9_(s){var t=0,e=[];if(0!==s.tProducts.productsTypes.length){s.tProducts.productsTypes.forEach(function(s,e){t+=s.amount}),e.push(t);var i=s.tProducts.indexPic.split(",")[0];$(".all").append('<div class="details"><div class="details-left"> <img src="'+i+'" alt=""></div><div class="details-con width"> <div class="details-con-top">'+s.tProducts.pname+' </div> <div class="price price-charge price-tuan">'+s.tProducts.productsTypes[0].tuanPrice+"<span>￥"+s.tProducts.productsTypes[0].newPrice+"</span></div><span>待付款 "+s.amount+"件 总价"+s.totalPrice+'</span><br><span class="nums num">  剩余库存：'+e[0]+" 已卖出："+s.tProducts.saleNum+" </span>  <div>团购号："+s.groupCode+"</div>   <span>订单号："+s.code+'</span> </div><span style="font-size:20px;color:red">待付款团购订单</span> <div class="fahuo-tuan-ready" title="true">   <input type="button" value="查看详情" name="true"> </div> <div class="details-details-cons-tuan-ready"><div class="details-details-cons-tuan-con">   <div class="order-datails">  <div class="order-details-con">  <span>'+s.tDeliver.receiver+"   "+s.tDeliver.phone+"</span>    <span>"+s.tDeliver.address+'</span> </div> <div class="order-details-con"> <span>颜色：'+s.tProductsTypes.color+" 尺码："+s.tProductsTypes.size+"</span><br>   <span>待付款 "+s.amount+"件 总价"+s.totalPrice+'</span> </div> </div> <span class="order-creattime">下单时间：'+s.tDeliver.createDate+"</span> </div> </div></div>")}}function addhtml10_(s){var t=s.tProducts.indexPic.split(",")[0],e=0;s.tProducts.productsTypes.forEach(function(s,t){e+=s.amount}),amount_.push(e),$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+t+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s.code+"</div>\n"+s.tProducts.pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s.tProductsTypes.color+'</span>\n<span class="chima">尺码：'+s.tProductsTypes.size+'</span>\n</div>\n<div class="price price-charge" style="color:red">\n售价：￥'+s.totalPrice+'  &nbsp&nbsp<span style="text-decoration: line-through;color:#999;">'+s.tProductsTypes.newPrice+'</span>    </div>\n    <span class="nums num">\n剩余库存：'+amount_[0]+"已卖出： "+s.tProducts.saleNum+'\n</span>\n</div>\n<div class="details-right-charge">\n    <div class="address">\n'+s.tDeliver.receiver+s.tDeliver.phone+"<br>\n"+s.tDeliver.address+'</div>\n<div class="data">\n'+s.createDate+'<div class="status">\n待付款 '+s.amount+"件 总价："+s.totalPrice+'<br><span style="font-size:20px;color:red">待付款个人订单</span></div>\n</div>\n</div>\n    </div>')}function addhtml11_(s){if(0!==s.tProducts.productsTypes.length){var t=[],e=s.tProducts.indexPic.split(",")[0],i=0;s.tProducts.productsTypes.forEach(function(s,t){i+=s.amount}),t.push(i),$(".all").append('<div class="details">\n    <div class="details-left">\n           <img src="'+e+'" alt="">\n    </div>\n    <div class="details-con width">\n    <div class="details-con-top">\n<div>订单号：'+s.code+"</div>\n"+s.tProducts.pname+'</div>\n<div class="style">\n<span class="yanse">颜色：'+s.tProducts.productsTypes[0].color+'</span>\n<span class="chima">尺码：'+s.tProducts.productsTypes[0].size+'</span>\n</div>\n<div class="price price-charge">\n标价：￥<span style="color:black;text-decoration: none">'+s.tProducts.productsTypes[0].tuanPrice+'</div>\n    <span class="nums num">\n剩余库存：'+t[0]+"    已卖出： "+s.tProducts.saleNum+'\n</span>\n</div>\n<div class="details-right-charge">\n<span style="font-size:20px;">拼团失败订单</span><div class="fahuo revise-price" title="">\n更多\n</div>\n</div>\n<div class="details-details-cons"><div class="details-details-con"><div class="details-ul-wait-pin"><ul><li class="wait-pin"><div>本订单所有人：'+s.tDeliver.receiver+"<br>微信昵称："+s.wxname+"</div><div>拼主：<span>"+s.owner+'</span></div><div>开始时间：<span style="color:red">'+s.startDate+'</span></div><div>截止时间：<span style="color:red">'+s.endDate+"</span></div></li></ul></div></div></div>\n    </div>")}}$("body").on("click",".sure-price",function(){var s=$(this).siblings("input").val();if(""!==s&&/^\d{0,8}\.{0,1}(\d{1,2})?$/.test(s)){var t=$(this).siblings(".id").html(),e=$(this).parents(".details").find(".active").html(),i=$(this).parents(".details").find(".amount").html(),a=$(this);$.post(localhost+"/tuan/produttypes/update",{saleId:token,id:t,active:e,newPrice:s,amount:i,online_code:onlinecode},function(t){outline(t),"操作成功"===t.message?(a.parents(".list").find(".newPrice").text(s),a.siblings("input").val("")):alert("未修改成功！")})}}),$("body").on("click",".sure-nums",function(){var s=$(this).siblings("input").val();if(""!==s){var t=$(this).siblings(".id").html(),e=$(this).parents(".details").find(".active").html(),i=$(this).parents(".details").find(".newPrice").html(),a=$(this);$.post(localhost+"/tuan/produttypes/update",{saleId:token,id:t,active:e,amount:s,newPrice:i,online_code:onlinecode},function(t){outline(t),"操作成功"===t.message?(a.parents("span").siblings("span").eq(4).html(s),a.siblings("input").val("")):alert("未修改成功！")})}}),$("body").on("click",".del",function(){var s=$(this).parents(".details").find(".produt-id span").text(),t=$(this).parents(".details").index(),e=$(this).parents(".list").index()-1,i=$(this).find(".id").html(),a=$(this).parents(".list").find(".amount").html(),n=$(this).parents(".list").find(".newPrice").html();$(this);$.post(localhost+"/tuan/produttypes/update",{saleId:token,id:i,active:!1,amount:a,newPrice:n,online_code:onlinecode},function(i){outline(i),"操作成功"===i.message&&$(".details").eq(t).find(".list").eq(e).remove(),0===$(".details").eq(t).find(".del").length&&$.post(localhost+"/tuan/product/update",{saleId:token,id:s,active:!1,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$(".details").eq(t).remove()}),0===$(".details").length&&$(".pages").hide()})}),$("body").on("click",".down",function(){var s=$(this).parents(".details").find(".produt-id span").text(),t=$(this).parents(".details").index();$.post(localhost+"/tuan/product/update",{saleId:token,id:s,active:!1,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$(".details").eq(t).remove()})}),$("body").on("click",".fix",function(){var s=$(this).parents(".details").find(".produt-id span").text(),t=$(this).parents(".details").find(".active").text();localStorage.setItem("fix",s),localStorage.setItem("isactive",t),location.href="fix_pin.html"}),$("body").on("click",".shangjia",function(){var s=$(this).parents(".details").find(".id_id").text(),t=$(this);$.post(localhost+"/tuan/product/update",{saleId:token,id:s,active:!0,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&(alert("上架成功！"),t.parents(".details").remove())})});function findlist(s,t,e){for(var i=[],a=0;a<s.length;a++)i.push(s[a].indexOf(e));for(var n=0;n<i.length;n++)i[n]>=0&&(showlist.push(s[n]),enlist.push(t[n]))}$("body").on("click",".fahuo",function(){""===$(this).attr("title")?($(this).parents(".details-right-charge").siblings(".details-details-cons").stop(!0).slideDown(),$(this).prop("title","发货")):($(this).parents(".details-right-charge").siblings(".details-details-cons").stop(!0).slideUp(),$(this).prop("title",""))}),$(".all").on("click",".fahuo-tuan input",function(){var stu=!0===eval($(this).prop("name"));$(this).prop("name",!stu),stu?($(this).val("隐藏"),$(this).parents(".details").find(".details-details-cons-tuan").slideDown()):($(this).val("填写物流单号"),$(this).parents(".details").find(".details-details-cons-tuan").slideUp())}),$(".all").on("click",".order-img",function(){var stu=!0===eval($(this).prop("title"));$(this).prop("title",!stu),stu?($(this).css({transform:"rotate(180deg)"}),$(this).parent(".ordernumber-tuan").next(".details-details-cons-tuan-cons").slideDown()):($(this).css({transform:" rotate(0deg)"}),$(this).parent(".ordernumber-tuan").next(".details-details-cons-tuan-cons").slideUp())}),$(".all").on("click",".fahuo-tuan-ready input",function(){var stu=!0===eval($(this).prop("name")),dcode=$(this).parents(".details").find(".dcode").text(),that=$(this);$(this).prop("name",!stu),stu?($(this).val("隐藏"),$(this).parents(".details").find(".details-details-cons-tuan-ready").slideDown()):($(this).val("查看详情"),$(this).parents(".details").find(".details-details-cons-tuan-ready").slideUp())}),$("body").on("input",".details-ul-input",function(){showlist=[],enlist=[];var s=$(this).val();$(this).parents().siblings(".details-ul ul").html("");/^[\u4E00-\u9FA5]+$/.test(s)&&findlist(list_zh,list_en,s);for(var t=0;t<showlist.length;t++)$(this).parents().siblings(".details-ul ul").append("<li>"+showlist[t]+"</li>");""===s&&$(this).parents().siblings(".details-ul ul").html("")}),$("body").on("click",".details-ul li",function(){(dename=[]).push(enlist[$(this).index()]),$(this).parents(".details-ul ul").siblings("div").find(".details-ul-input").val($(this).text()),$(this).parents(".details-ul ul").html("")}),$("body").on("click",".express-sure",function(){var s=$(this).parents(".details").index(),t=$(this).siblings(".oid").text(),e=$(this).siblings(".express").find("input").val(),i=$(this).siblings(".details-ul").find("input").val(),a=$(this).parents(".details").find(".deliverId").html();$.post(localhost+"/tuan/tdeliver/update",{id:a,oid:t,saleId:token,dcode:e,dname:i,online_code:onlinecode},function(e){outline(e),1==e.error?alert(e.message):"操作成功"===e.message&&(alert(e.message),$.post(localhost+"/tuan/torders/changestate",{oid:t,state:"待收货订单",saleId:token,online_code:onlinecode},function(t){outline(t),1==t.error?alert(t.message):"操作成功"===t.message&&$(".all").find(".details").eq(s).remove()}))})}),$(".all").on("click",".fahuo-geren",function(){var s=$(this).parents(".details-details-cons-tuan-con").find(".dliverid").html(),t=$(this).parents(".details-details-cons-tuan-con").find(".tuanid").html(),e=$(this).parents(".express-tuan-con").find("input").eq(0).val(),i=$(this).parents(".express-tuan-con").find("input").eq(1).val(),a=$(this).parents(".details-details-cons-tuan-con").index(),n=$(this);$.post(localhost+"/tuan/tdeliver/update_tuan",{id:s,dcode:e,dname:i,saleId:token,oid:t,online_code:onlinecode},function(s){outline(s),s.error?alert(s.message):"操作成功"===s.message&&$.post(localhost+"/tuan/tuanorders/changestate",{oid:t,state:"待收货团购订单",saleId:token,online_code:onlinecode},function(s){outline(s),s.error?alert(s.message):"操作成功"===s.message?(alert("发货成功"),n.parents(".details-details-cons-tuan-cons").find(".details-details-cons-tuan-con").eq(a).remove(),0===n.parents(".details-details-cons-tuan-cons").find(".details-details-cons-tuan-con").length&&n.parents(".details-details-cons-tuan-cons").remove()):alert(s.message)})})});function search(){var s=$(".number input").val(),t=$(".input-time input").eq(0).val(),e=$(".input-time input").eq(1).val(),i=$(".nickname input").val();if(""===e&&""===t||""!==e&&""!==t){if(""!==t&&""!==e){if(!reg.test(t))if(reg2.test(t))t=t.split(".").join("-");else{if(!reg1.test(t))return alert("日期格式为  年-月-日"),!1;t=t.split("/").join("-")}if(!reg.test(e))if(reg2.test(e))e=e.split(".").join("-");else{if(!reg1.test(e))return alert("日期格式为  年-月-日"),!1;e=e.split("/").join("-")}}$.post(localhost+"/tuan/torders/query",{code:s,startDate:t,endDate:e,wxname:i,order_type:order_type,saleId:token,online_code:onlinecode},function(s){if(outline(s),$(".all").html(""),null!==s.data){s.data.forEach(function(s,t){switch(s.state){case"已完成团购订单":addhtml8_(s);break;case"待收货团购订单":addhtml7_(s);break;case"待付款团购订单":addhtml9_(s);break;case"待发货团购订单":addhtml6_(s);break;case"正在拼团团购订单":addhtml1_(s);break;case"拼团失败订单":addhtml11_(s);break;case"待付款订单":addhtml10_(s);break;case"待发货订单":addhtml3_(s);break;case"已完成订单":addhtml5_(s);break;case"待收货订单":addhtml2_(s)}})}})}else alert("开始日期与结束日期必须全部填写完整或或全部不填")}$("select").click(function(){var s=$("select option:selected").val();order_type=s}),$(".search-sure input").click(function(){search()}),$("body").on("keydown",function(s){13===s.keyCode&&search()});
/*2018-01-05*/