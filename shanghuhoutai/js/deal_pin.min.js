/*By 任龙飞—renlongfei*/
var amount_=[],saleNumber_=[],content,pages=0,pagesindex=0,showlist=[],enlist=[],dename=[],style_="/tuan/product/list",reg=/^[0-9]{4}-[0-1]?[0-9]{1}-[0-3]?[0-9]{1}$/,reg1=/^[0-9]{4}\/[0-1]?[0-9]{1}\/[0-3]?[0-9]{1}$/,reg2=/^[0-9]{4}\.[0-1]?[0-9]{1}\.[0-3]?[0-9]{1}$/,details_={pageNumber:pages,pageSize:10,saleId:token,active:!0,online_code:onlinecode},nums=0;"0"===authority&&($(".body-top ul li:gt(0)").css({display:"none"}),$(".body-top ul").css({background:"#18cffb"})),$("body").on("click",".edit",function(){""===$(this).attr("title")?($(this).siblings(".details-details").stop(!0).slideDown(),$(this).prop("title","编辑")):($(this).siblings(".details-details").stop(!0).slideUp(),$(this).prop("title",""))});function chageStyle(s,e,t){console.log(this),2===arguments.length?(this.style_=s,this.details_={pageNumber:pages,pageSize:10,saleId:token,active:!0,online_code:onlinecode},this.html_=e):(this.style_=s,this.details_={pageNumber:pages,pageSize:10,saleId:token,active:!0,state:t,online_code:onlinecode},this.html_=e)}function addhtml1_(s){if($(".all").html(""),0===s.length)return $(".all").html("您没有待拼订单！"),!1;for(var e=[],t=0;t<s.length;t++){var n=s[t].products.indexPic.split(",")[0],a=0;s[t].products.productsTypes.forEach(function(s,e){a+=s.amount}),e.push(a),$(".all").append('<div class="details"><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span>团购号：'+s[t].iterable[0].groupCode+"</span>&nbsp;&nbsp;<span> 个人订单号："+s[t].iterable[0].code+'</div><div class="details-con"><div class="details-con-img"><img src="'+n+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s[t].products.pname+'</p><div class="produce-style"><span class="price">标价：￥'+s[t].products.productsTypes[0].tuanPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+s[t].products.productsTypes[0].color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+s[t].products.productsTypes[0].size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">剩余库存：'+e[0]+"已卖出："+s[t].products.saleNum+'\n</div></div><div class="fahuo" title="">\n更多\n</div>\n</div><div class="details-details-cons"></div>\n</div>');for(var i=s[t].iterable,l=0;l<i.length;l++){var d=i[l].endDate;d=(d=new Date(Date.parse(d.replace(/-/g,"/")))).getTime();$(".details-details-cons").eq(t).append('<ul><li class="wait-pin"><div>拼主：<span>'+i[l].owner+'</span></div><div>还差<span style="color:red">'+(i[l].startNum-i[l].joinNum)+'</span>人</div><div>剩余时间：<span style="color:red">'+function(s){var e=s-Date.now(),t=Math.floor(e/36e5),n=e-3600*t*1e3,a=Math.floor(n/6e4),i=(n-60*a*1e3)/1e3;return t.toString()+": "+a.toString()+": "+i.toFixed(2)}(d)+"</span></div></li></ul>")}}}function addhtml2_(s){if($(".all").html(""),0===s.length)return $(".all").html("您没有已发货个人订单！"),!1;$(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="generateTable">生成表格</div></div>');for(var e=0;e<s.length;e++){var t=s[e].tProducts.indexPic.split(",")[0],n=0;s[e].tProducts.productsTypes.forEach(function(s,e){n+=s.amount}),null==s[e].leavemsg&&(s[e].leavemsg="无"),null==s[e].leavemsg2&&(s[e].leavemsg2="无"),amount_.push(n),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+s[e].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span> 订单号：'+s[e].code+"</span>&nbsp;&nbsp;<span>成交时间："+s[e].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+t+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s[e].tProducts.pname+'</p><div class="produce-style"><span class="price">单价：￥'+s[e].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+s[e].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+s[e].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+s[e].amount+"件&nbsp;&nbsp;&nbsp;共"+s[e].totalPrice+'元</div><div class="seller-beizhu">卖家备注：'+s[e].leavemsg2+'</div></div><div class="details-con-Buyers"><div class="name-tel">'+s[e].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+s[e].tDeliver.phone+'</div><p class="address"> 地址：'+s[e].tDeliver.address+'</p><div class="beizhu">买家备注：'+s[e].leavemsg+'</div></div><div class="see-wuliu" title="">\n查看物流\n</div>\n</div><div class="details-details-cons"><div class="wuliu" ><span>物流公司：'+s[e].tDeliver.dname+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>物流单号："+s[e].tDeliver.dcode+"</span></div></div>\n</div>")}}function addhtml3_(s){if($(".all").html(""),0===s.length)return $(".all").html("您没有未发货个人订单！"),!1;$(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="generateTable">生成表格</div></div>');for(var e=[],t=0;t<s.length;t++){var n=s[t].tProducts.indexPic.split(",")[0],a=0;s[t].tProducts.productsTypes.forEach(function(s,e){a+=s.amount}),e.push(a),null==s[t].leavemsg&&(s[t].leavemsg="无"),null==s[t].leavemsg2&&(s[t].leavemsg2="无"),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+s[t].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span> 订单号：'+s[t].code+"</span>&nbsp;&nbsp;<span>成交时间："+s[t].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+n+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s[t].tProducts.pname+'</p><div class="produce-style"><span class="price">单价：￥'+s[t].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+s[t].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+s[t].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+s[t].amount+"件&nbsp;&nbsp;&nbsp;共"+s[t].totalPrice+'元</div><div class="seller-beizhu"><div>卖家备注：</div><p></p><button class="tianxie">填写备注</button ></div></div><div class="details-con-Buyers"><div class="name-tel">'+s[t].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+s[t].tDeliver.phone+'</div><p class="address"> 地址：'+s[t].tDeliver.address+'</p><div class="beizhu">买家备注：'+s[t].leavemsg+'</div></div><div class="fahuo" title="">\n发货\n</div>\n</div><div class="details-details-cons"><div class="details-ul"><input type="text" class="details-ul-input" placeholder="物流公司"></div><span class="did" style="display: none">'+s[t].tDeliver.id+'</span><div class="express"><input type="text" placeholder="物流订单号"></div><div class="fahuo-sure">确定发货</div></div>\n</div>')}}function addhtml5_(s){if($(".all").html(""),0===s.length)return $(".all").html("您没有已完成的个人订单！"),!1;$(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="generateTable">生成表格</div></div>');for(var e=0;e<s.length;e++){var t=s[e].tProducts.indexPic.split(",")[0],n=0;s[e].tProducts.productsTypes.forEach(function(s,e){n+=s.amount}),amount_.push(n),null==s[e].leavemsg&&(s[e].leavemsg="无"),null==s[e].leavemsg2&&(s[e].leavemsg2="无"),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+s[e].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span> 订单号：'+s[e].code+"</span>&nbsp;&nbsp;<span>成交时间："+s[e].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+t+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s[e].tProducts.pname+'</p><div class="produce-style"><span class="price">单价：￥'+s[e].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+s[e].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+s[e].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+s[e].amount+"件&nbsp;&nbsp;&nbsp;共"+s[e].totalPrice+'元</div><div class="seller-beizhu">卖家备注：'+s[e].leavemsg2+'</div></div><div class="details-con-Buyers"><div class="name-tel">'+s[e].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+s[e].tDeliver.phone+'</div><p class="address"> 地址：'+s[e].tDeliver.address+'</p><div class="beizhu">买家备注：'+s[e].leavemsg+'</div></div><div class="see-wuliu" title="">\n查看物流\n</div>\n</div><div class="details-details-cons"><div class="wuliu" ><span>物流公司：'+s[e].tDeliver.dname+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>物流单号："+s[e].tDeliver.dcode+"</span></div></div>\n</div>")}}function addhtml6_(s){$(".all").html(""),0===s.length||null===s?$(".all").append("您没有未发货的团购订单"):($(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="tuan-generateTable">生成表格</div></div>'),s.forEach(function(s,e){var t=[],n={},a=0;s.tuanOrdersList.forEach(function(s,e){n[s.groupCode]||(t.push(s.groupCode),n[s.groupCode]=1)}),s.products.productsTypes.forEach(function(s,e){a+=s.amount}),[].push(a);for(var i=s.products.indexPic.split(",")[0],l=0;l<t.length;l++)for(var d=s.tuanOrdersList,o=0;o<d.length;o++)d[o].groupCode===t[l]&&(null==d[o].leavemsg&&(d[o].leavemsg="无"),null==d[o].leavemsg2&&(d[o].leavemsg2="无"),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+d[o].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span>团购号：'+d[o].groupCode+"</span>&nbsp;&nbsp;<span> 订单号："+d[o].code+"</span>&nbsp;&nbsp;<span>成交时间："+d[o].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+i+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s.products.pname+'</p><div class="produce-style"><span class="price">团价：￥'+d[o].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+d[o].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+d[o].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+d[o].amount+"件&nbsp;&nbsp;&nbsp;共"+d[o].totalPrice+'元</div><div class="seller-beizhu"><div>卖家备注：</div><p></p><button class="tuan-tianxie">填写备注</button ></div></div><div class="details-con-Buyers"><div class="name-tel">'+d[o].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+d[o].tDeliver.phone+'</div><p class="address"> 地址：'+d[o].tDeliver.address+'</p><div class="beizhu">买家备注：'+d[o].leavemsg+'</div></div><div class="fahuo" title="">\n发货\n</div>\n</div><div class="details-details-cons"><div class="details-ul"><input type="text" class="details-ul-input" placeholder="物流公司"></div><span class="did" style="display: none">'+d[o].tDeliver.id+'</span><div class="express"><input type="text" placeholder="物流订单号"></div><div class="tuan-fahuo-sure">确定发货</div></div>\n</div>'))}))}function addhtml7_(s){$(".all").html(""),0===s.length||null===s?$(".all").append("您没有已发货的团购订单"):($(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="tuan-generateTable">生成表格</div></div>'),s.forEach(function(s,e){var t=[],n={},a=0;s.tuanOrdersList.forEach(function(s,e){n[s.groupCode]||(t.push(s.groupCode),n[s.groupCode]=1)}),s.products.productsTypes.forEach(function(s,e){a+=s.amount}),[].push(a);var i=s.products.indexPic.split(",")[0];console.log(s);for(var l=s.tuanOrdersList,d=0;d<l.length;d++)null==l[d].leavemsg&&(l[d].leavemsg="无"),null==l[d].leavemsg2&&(l[d].leavemsg2="无"),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+l[d].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span>团购号：'+l[d].groupCode+"</span>&nbsp;&nbsp;<span> 订单号："+l[d].code+"</span>&nbsp;&nbsp;<span>成交时间："+l[d].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+i+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s.products.pname+'</p><div class="produce-style"><span class="price">团价：￥'+l[d].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+l[d].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+l[d].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+l[d].amount+"件&nbsp;&nbsp;&nbsp;共"+l[d].totalPrice+'元</div><p class="seller-beizhu">卖家备注：'+l[d].leavemsg2+'</p></div><div class="details-con-Buyers"><div class="name-tel">'+l[d].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+l[d].tDeliver.phone+'</div><p class="address"> 地址：'+l[d].tDeliver.address+'</p><div class="beizhu">买家备注：'+l[d].leavemsg+'</div></div><div class="see-wuliu" title="">\n查看物流\n</div>\n</div><div class="details-details-cons"><div class="wuliu" ><span>物流公司：'+l[d].tDeliver.dname+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>物流单号："+l[d].tDeliver.dcode+"</span></div></div>\n</div>")}))}function addhtml8_(s){$(".all").html(""),0===s.length||null===s?$(".all").append("您没有已完成的团购订单"):($(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="tuan-generateTable">生成表格</div></div>'),s.forEach(function(s,e){var t=[],n={},a=0;s.tuanOrdersList.forEach(function(s,e){n[s.groupCode]||(t.push(s.groupCode),n[s.groupCode]=1)}),s.products.productsTypes.forEach(function(s,e){a+=s.amount}),[].push(a);for(var i=s.products.indexPic.split(",")[0],l=s.tuanOrdersList,d=0;d<l.length;d++)null==l[d].leavemsg&&(l[d].leavemsg="无"),null==l[d].leavemsg2&&(l[d].leavemsg2="无"),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+l[d].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span>团购号：'+l[d].groupCode+"</span>&nbsp;&nbsp;<span> 订单号："+l[d].code+"</span>&nbsp;&nbsp;<span>成交时间："+l[d].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+i+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s.products.pname+'</p><div class="produce-style"><span class="price">团价：￥'+l[d].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+l[d].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+l[d].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+l[d].amount+"件&nbsp;&nbsp;&nbsp;共"+l[d].totalPrice+'元</div><p class="seller-beizhu">卖家备注：'+l[d].leavemsg2+'</p></div><div class="details-con-Buyers"><div class="name-tel">'+l[d].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+l[d].tDeliver.phone+'</div><p class="address"> 地址：'+l[d].tDeliver.address+'</p><div class="beizhu">买家备注：'+l[d].leavemsg+'</div></div><div class="see-wuliu" title="">\n查看物流\n</div>\n</div><div class="details-details-cons"><div class="wuliu" ><span>物流公司：'+l[d].tDeliver.dname+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>物流单号："+l[d].tDeliver.dcode+"</span></div></div>\n</div>")}))}function addhtml13_(s){if($(".all").html(""),0===s.length||null===s)$(".all").append("没有搜索到订单");else{$(".all").append('<div class="choice-query-form"><div class="allChoice"><input class="all-choice" type="checkbox" name="allChoice" />全选&nbsp;&nbsp;</div><div class="queryOrder">查询订单</div><div class="tuan-generateTable">生成表格</div></div>');for(var e=0;e<s.length;e++){var t=s[e].tProducts.indexPic.split(",")[0],n=0;s[e].tProducts.productsTypes.forEach(function(s,e){n+=s.amount}),null==s[e].leavemsg&&(s[e].leavemsg="无"),null==s[e].leavemsg2&&(s[e].leavemsg2="无"),amount_.push(n),$(".all").append('<div class="details"><div class="oNum" style="display:none;">'+s[e].id+'</div><div class="details-top"><input type="checkbox" class="checkbox"/>&nbsp;<span> 订单号：'+s[e].code+"</span>&nbsp;&nbsp;<span>成交时间："+s[e].tDeliver.createDate+'</span></div><div class="details-con"><div class="details-con-img"><img src="'+t+'" alt="">\n</div><div class="details-con-seller"><p class="pname">'+s[e].tProducts.pname+'</p><div class="produce-style"><span class="price">单价：￥'+s[e].tProductsTypes.newPrice+'</span>&nbsp;&nbsp;&nbsp;<span class="yanse">颜色：'+s[e].tProductsTypes.color+'</span>&nbsp;&nbsp;&nbsp;<span class="chima">尺码：'+s[e].tProductsTypes.size+'</span>&nbsp;&nbsp;&nbsp;</div><div class="num">'+s[e].amount+"件&nbsp;&nbsp;&nbsp;共"+s[e].totalPrice+'元</div><div class="seller-beizhu">卖家备注：'+s[e].leavemsg2+'</div></div><div class="details-con-Buyers"><div class="name-tel">'+s[e].tDeliver.receiver+"&nbsp;&nbsp;&nbsp;"+s[e].tDeliver.phone+'</div><p class="address"> 地址：'+s[e].tDeliver.address+'</p><div class="beizhu">买家备注：'+s[e].leavemsg+'</div></div><div class="see-wuliu" title="">\n查看物流\n</div>\n<div class="order-style">'+s[e].state+'</div></div><div class="details-details-cons"><div class="wuliu" ><span>物流公司：'+s[e].tDeliver.dname+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>物流单号："+s[e].tDeliver.dcode+"</span></div></div>\n</div>"),void 0!=s[e].groupCode&&$("<span>团购号："+s[e].groupCode+"</span>&nbsp;&nbsp;").insertBefore(".details-top span:eq(0)")}}}function queryOrder(){$("body").append('<div class="search-con"><div class="input option"><span>订单类型：（必填）</span><select><option></option><option value="2">团购订单</option><option value="1">个人订单</option></select></div><div class="input number"><span>订单编号：</span><input type="text" placeholder="订单编号"></div><div class="input nickname"><span>买家昵称：</span><input type="text" placeholder="买家昵称"></div><div class="input-time"><span>成交时间：</span><input type="text" placeholder="开始时间"><span>——</span><input type="text" placeholder="结束时间"></div><div class="search-sure"><input type="button" value="开始搜索" class="begin">&nbsp;&nbsp;&nbsp;&nbsp;<input type="button" value="取消" class="dele"></div></div>')}$(".all").on("click",".queryOrder",function(){queryOrder(),$(".search-con").hide(),$(".search-con").slideDown("fast")}),$(document).on("click",".search-con .dele",function(){console.log(123),$(this).parents(".search-con").remove()});function search(){var s=$(".number input").val(),e=$(".input-time input").eq(0).val(),t=$(".input-time input").eq(1).val(),n=$(".nickname input").val();if(""===t&&""===e||""!==t&&""!==e){if(""!==e&&""!==t){if(!reg.test(e))if(reg2.test(e))e=e.split(".").join("-");else{if(!reg1.test(e))return alert("日期格式为  年-月-日"),!1;e=e.split("/").join("-")}if(!reg.test(t))if(reg2.test(t))t=t.split(".").join("-");else{if(!reg1.test(t))return alert("日期格式为  年-月-日"),!1;t=t.split("/").join("-")}}$.post(localhost+"/tuan/torders/query",{code:s,startDate:e,endDate:t,wxname:n,order_type:order_type,saleId:token,online_code:onlinecode},function(s){if(outline(s),$(".all").html(""),null!==s.data){addhtml13_(s.data),$(".body-top .li:eq(4)").addClass("li-change").siblings().removeClass("li-change")}})}else alert("开始日期与结束日期必须全部填写完整或或全部不填")}$(document).on("click",".search-con select",function(){var s=$("select option:selected").val();order_type=s}),$(document).on("click",".search-sure .begin",function(){search(),$(this).parents(".search-con").remove()}),$("body").on("keydown",function(s){13===s.keyCode&&search()}),$(".body-top ul li").click(function(){var s=$(this).index();switch(pages=0,$(".all").html(""),s){case 0:$.post(localhost+"/tuan/tuanorders/tuaning_list",{saleId:token,online_code:onlinecode},function(s){outline(s);var e=s.data;addhtml1_(e),0===e.length?$(".pages").hide():$(".pages").show()})}}),$("body").on("click",".tuan",function(s){var e=$(this).parents("li").index();switch(pages=0,e){case 1:$.post(localhost+"/tuan/tuanorders/list",{saleId:token,state:"待发货团购订单",online_code:onlinecode},function(s){outline(s);var e=s.data;addhtml6_(e),0===e.length?$(".pages").hide():$(".pages").show()}),chageStyle("/tuan/tuanorders/list",addhtml6_,"待发货团购订单");break;case 2:return $.post(localhost+"/tuan/tuanorders/list",{saleId:token,state:"待收货团购订单",online_code:onlinecode},function(s){outline(s);var e=s.data;addhtml7_(e),0===e.length?$(".pages").hide():$(".pages").show()}),chageStyle("/tuan/tuanorders/list",addhtml7_,"待收货团购订单"),!1;case 3:$.post(localhost+"/tuan/tuanorders/list",{saleId:token,state:"已完成团购订单",showsale:!0,online_code:onlinecode},function(s){outline(s);var e=s.data;addhtml8_(e),0===e.length?$(".pages").hide():$(".pages").show()}),chageStyle("/tuan/tuanorders/list",addhtml8_,"已完成团购订单")}return!1}),$("body").on("click",".person",function(){var s=$(this).parents("li").index();switch(pages=0,console.log($(this)),s){case 1:$.post(localhost+"/tuan/torders/list",{saleId:token,state:"待发货订单",online_code:onlinecode},function(s){outline(s);var e=s.data.content;addhtml3_(e),0===e.length?$(".pages").hide():$(".pages").show()}),chageStyle("/tuan/torders/list",addhtml3_,"待发货订单");break;case 2:$.post(localhost+"/tuan/torders/list",{saleId:token,state:"待收货订单",online_code:onlinecode},function(s){outline(s);var e=s.data.content;addhtml2_(e),0===e.length?$(".pages").hide():$(".pages").show()}),chageStyle("/tuan/torders/list",addhtml2_,"待收货订单");break;case 3:$.post(localhost+"/tuan/torders/list",{saleId:token,state:"已完成订单",showsale:!0,online_code:onlinecode},function(s){outline(s);var e=s.data.content;addhtml5_(e),0===e.length?$(".pages").hide():$(".pages").show()}),chageStyle("/tuan/torders/list",addhtml5_,"已完成订单")}}),$.post(localhost+"/tuan/tuanorders/tuaning_list",{saleId:token,online_code:onlinecode},function(s){outline(s);var e=s.data;addhtml1_(e),0===e.length?$(".pages").hide():$(".pages").show()}),$("body").on("click",".sure-price",function(){var s=$(this).siblings("input").val();if(""!==s&&/^\d{0,8}\.{0,1}(\d{1,2})?$/.test(s)){var e=$(this).siblings(".id").html(),t=$(this).parents(".details").find(".active").html(),n=$(this).parents(".details").find(".amount").html(),a=$(this);$.post(localhost+"/tuan/produttypes/update",{saleId:token,id:e,active:t,newPrice:s,amount:n,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message?(a.parents(".list").find(".newPrice").text(s),a.siblings("input").val("")):alert("未修改成功！")})}}),$("body").on("click",".sure-nums",function(){var s=$(this).siblings("input").val();if(""!==s){var e=$(this).siblings(".id").html(),t=$(this).parents(".details").find(".active").html(),n=$(this).parents(".details").find(".newPrice").html(),a=$(this);$.post(localhost+"/tuan/produttypes/update",{saleId:token,id:e,active:t,amount:s,newPrice:n,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message?(a.parents("span").siblings("span").eq(4).html(s),a.siblings("input").val("")):alert("未修改成功！")})}}),$("body").on("click",".del",function(){var s=$(this).parents(".details").find(".produt-id span").text(),e=$(this).parents(".details").index(),t=$(this).parents(".list").index()-1,n=$(this).find(".id").html(),a=$(this).parents(".list").find(".amount").html(),i=$(this).parents(".list").find(".newPrice").html();$(this);$.post(localhost+"/tuan/produttypes/update",{saleId:token,id:n,active:!1,amount:a,newPrice:i,online_code:onlinecode},function(n){outline(n),"操作成功"===n.message&&$(".details").eq(e).find(".list").eq(t).remove(),0===$(".details").eq(e).find(".del").length&&$.post(localhost+"/tuan/product/update",{saleId:token,id:s,active:!1,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$(".details").eq(e).remove()}),0===$(".details").length&&$(".pages").hide()})}),$("body").on("click",".down",function(){var s=$(this).parents(".details").find(".produt-id span").text(),e=$(this).parents(".details").index();$.post(localhost+"/tuan/product/update",{saleId:token,id:s,active:!1,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&$(".details").eq(e).remove()})}),$("body").on("click",".fix",function(){var s=$(this).parents(".details").find(".produt-id span").text(),e=$(this).parents(".details").find(".active").text();console.log(s),localStorage.setItem("fix",s),localStorage.setItem("isactive",e),location.href="fix_pin.html"}),$("body").on("click",".shangjia",function(){var s=$(this).parents(".details").find(".id_id").text(),e=$(this);$.post(localhost+"/tuan/product/update",{saleId:token,id:s,active:!0,online_code:onlinecode},function(s){outline(s),"操作成功"===s.message&&(alert("上架成功！"),e.parents(".details").remove())})});function findlist(s,e,t){for(var n=[],a=0;a<s.length;a++)n.push(s[a].indexOf(t));for(var i=0;i<n.length;i++)n[i]>=0&&(showlist.push(s[i]),enlist.push(e[i]))}$(".all").on("click","input.all-choice",function(){$(this).is(":checked")?$(this).parents(".all").find(".details .checkbox").prop("checked",!0):$(this).parents(".all").find(".details .checkbox").prop("checked",!1)}),$(".all").on("click",".details .checkbox",function(){$(this).is(":checked")||$(this).parents(".all").find("input.all-choice").prop("checked",!1)}),$(".all").on("click",".generateTable",function(){var s=[];$(this).parents(".all").find(".details .checkbox").each(function(){$(this).is(":checked")&&s.push($(this).parents(".details").find(".oNum").text())}),console.log(s),0===s.length?alert("请选择订单"):$.post(localhost+"/tuan/torders/excel",{saleId:token,oids:s.join("=")},function(s){s.error?alert(s.message):null!==s.data?location.href=s.data:alert("数据错误！")})}),$(".all").on("click",".tuan-generateTable",function(){var s=[];$(this).parents(".all").find(".details .checkbox").each(function(){$(this).is(":checked")&&s.push($(this).parents(".details").find(".oNum").text())}),0===s.length?alert("请选择订单"):$.post(localhost+"/tuan/tuanorders/excel",{saleId:token,oids:s.join("=")},function(s){s.error?alert(s.message):null!==s.data?location.href=s.data:alert("数据错误！")})}),$("body").on("click",".fahuo",function(){""===$(this).attr("title")?($(this).parents(".details").find(".details-details-cons").stop(!0).slideDown(),$(this).prop("title","发货")):($(this).parents(".details").find(".details-details-cons").stop(!0).slideUp(),$(this).prop("title",""))}),$(".all").on("click",".order-img",function(){var stu=!0===eval($(this).prop("title"));$(this).prop("title",!stu),stu?($(this).css({transform:"rotate(180deg)"}),$(this).parent(".ordernumber-tuan").next(".details-details-cons-tuan-cons").slideDown()):($(this).css({transform:" rotate(0deg)"}),$(this).parent(".ordernumber-tuan").next(".details-details-cons-tuan-cons").slideUp())}),$("body").on("click",".see-wuliu",function(){""===$(this).attr("title")?($(this).parents(".details").find(".details-details-cons").stop(!0).slideDown(),$(this).prop("title","查看物流")):($(this).parents(".details").find(".details-details-cons").stop(!0).slideUp(),$(this).prop("title",""))}),$("body").on("input",".details-ul-input",function(){showlist=[],enlist=[];var s=$(this).val();$(this).parents().siblings(".details-ul ul").html("");/^[\u4E00-\u9FA5]+$/.test(s)&&findlist(list_zh,list_en,s);for(var e=0;e<showlist.length;e++)$(this).parents().siblings(".details-ul ul").append("<li>"+showlist[e]+"</li>");""===s&&$(this).parents().siblings(".details-ul ul").html("")}),$("body").on("click",".details-ul li",function(){(dename=[]).push(enlist[$(this).index()]),$(this).parents(".details-ul ul").siblings("div").find(".details-ul-input").val($(this).text()),$(this).parents(".details-ul ul").html("")}),$("body").on("click",".fahuo-sure",function(){var s=$(this).parents(".details").find(".oNum").html(),e=$(this).siblings(".express").find("input").val(),t=$(this).siblings(".details-ul").find("input").val(),n=$(this).parents(".details").find(".did").html(),a=$(this);$.post(localhost+"/tuan/tdeliver/update",{id:n,oid:s,saleId:token,dcode:e,dname:t,online_code:onlinecode},function(e){outline(e),1==e.error?alert(e.message):"操作成功"===e.message&&(alert(e.message),$.post(localhost+"/tuan/torders/changestate",{oid:s,state:"待收货订单",saleId:token,online_code:onlinecode},function(s){outline(s),1==s.error?alert(s.message):"操作成功"===s.message&&a.parents(".details").remove()}))})}),$(".all").on("click",".tuan-tianxie",function(){var s,e=$(this).parents(".details").find(".oNum").html(),t=$(this);s=prompt("请填写备注"),$.post(localhost+"/tuan/tuanorders/leavemsg",{oid:e,saleId:token,leavemsg:s,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message&&t.parents(".details").find(".seller-beizhu p").text(s)})}),$(".all").on("click",".tianxie",function(){var s,e=$(this).parents(".details").find(".oNum").html(),t=$(this);s=prompt("请填写备注"),$.post(localhost+"/tuan/torders/leavemsg",{oid:e,saleId:token,leavemsg:s,online_code:onlinecode},function(e){outline(e),"操作成功"===e.message&&t.parents(".details").find(".seller-beizhu p").text(s)})}),$(".all").on("click",".tuan-fahuo-sure",function(){var s=$(this).parents(".details").find(".oNum").html(),e=$(this).siblings(".did").text(),t=$(this).siblings(".express").find("input").val(),n=$(this).siblings(".details-ul").find("input").val(),a=$(this);$.post(localhost+"/tuan/tdeliver/update_tuan",{id:e,dcode:t,dname:n,saleId:token,oid:s,online_code:onlinecode},function(e){outline(e),e.error?(alert(e.message),console.log(e)):"操作成功"===e.message&&$.post(localhost+"/tuan/tuanorders/changestate",{oid:s,state:"待收货团购订单",saleId:token,online_code:onlinecode},function(s){outline(s),s.error?alert(s.message):"操作成功"===s.message?(alert("发货成功"),a.parents(".details").remove()):alert(s.message)})})}),$(".next").click(function(){pages++,details_.pageNumber=pages,$.post(localhost+style_,details_,function(s){outline(s),0===(content=void 0===s.data.content?s.data:s.data.content).length?($(".message").html("这已经是最后一页了！").fadeIn(),setTimeout(function(){$(".message").fadeOut()},1e3),pages--,details_.pageNumber=pages,$.post(localhost+style_,details_,function(s){outline(s),content=void 0===s.data.content?s.data:s.data.content,html_(content),0===content.length?$(".pages").hide():$(".pages").show()})):(content=void 0===s.data.content?s.data:s.data.content,html_(content))})}),$(".last").click(function(){--pages<0?(pages=0,$(".message").html("这已经是第一页了！").fadeIn(),setTimeout(function(){$(".message").fadeOut()},1e3)):(details_.pageNumber=pages,$.post(localhost+style_,details_,function(s){outline(s),content=void 0===s.data.content?s.data:s.data.content,html_(content),0===content.length?$(".pages").hide():$(".pages").show()}))});
/*2018-01-08*/